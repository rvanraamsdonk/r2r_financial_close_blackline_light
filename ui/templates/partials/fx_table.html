{% for r in fx.rows %}
<tr class="border-t {% if r.diff_usd|abs > 500000 %}bg-red-50{% elif r.diff_usd|abs > 100000 %}bg-amber-50{% endif %}">
  <td class="px-2 py-2 text-center">
    <a title="Details" class="text-gray-500 hover:text-indigo-600" hx-get="/details?module=FX&period={{ fx.period }}&entity={{ r.entity }}&account={{ r.account }}" hx-target="#drawer-root" hx-swap="innerHTML">üîç</a>
  </td>
  <td class="px-3 py-2">{{ r.entity }}</td>
  <td class="px-3 py-2">{{ r.account }}</td>
  <td class="px-3 py-2">{{ r.currency }}</td>
  <td class="px-3 py-2 text-right">{{ '%.4f'|format(r.rate) }}</td>
  <td class="px-3 py-2 text-right">{{ '%.2f'|format(r.computed_usd) }}</td>
  <td class="px-3 py-2 text-right">{{ '%.2f'|format(r.reported_usd) }}</td>
  <td class="px-3 py-2 text-right font-medium {% if r.diff_usd >= 0 %}text-emerald-700{% else %}text-rose-700{% endif %}">
    {{ '%.2f'|format(r.diff_usd) }}
  </td>
  <td class="px-2 py-2 text-center">
    {% if r.diff_usd|abs > 0.01 %}
    <button type="button" 
            class="inline-flex items-center px-2 py-1 text-xs font-medium text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded border border-indigo-200 transition-colors"
            hx-post="/je/propose"
            hx-vals='{"module": "FX", "scenario": "fx_translation", "source_data": {{ r | tojson }}, "period": "{{ fx.period }}", "entity": "{{ r.entity }}"}'
            hx-target="body"
            hx-swap="beforeend"
            title="Propose journal entry for FX difference">
      <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
      </svg>
      JE
    </button>
    {% endif %}
  </td>
</tr>
{% else %}
<tr>
  <td colspan="8" class="px-3 py-6 text-center text-gray-500">No rows match current filters.</td>
</tr>
{% endfor %}
